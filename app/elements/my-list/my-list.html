<dom-module id="my-list">
  <style>
    /*:host {*/
      /*display: block;*/
    /*}*/

    /*section {*/
      /*padding: 2px;*/
      /*font-size: 16px;*/
      /*height: 100%;*/
      /*width: 100%;*/
    /*}*/

    paper-material {
      /*width: calc(97.33% - 32px);*/
      border-radius: 2px;
      height: 100%;
      /*width: 100%;*/
      margin: 10px;
      padding-left: 20px;
      padding-right: 20px;
      padding-top: 20px;
      padding-bottom: 20px;
      /*// width: calc(98.66% - 16px);*/
      background: #ffffff;
      border-color: #646464;
    }

    paper-slider {
      width: 100%;
    }

    .list {
      padding-top: 5px;
      background-color: #ffffff;
      display: inline-block;
      width: 50%;
      /*height: 228px;*/
      margin: 5px;
    @apply(--shadow-elevation-1.5dp);
    }

    h4 {
      margin-top:  5px;
      margin-bottom:  10px;
      margin-left: 12px;
      padding: 5px;
    }

    .avatar {
      display: inline-block;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      overflow: hidden;
      background: #e8e8e8;
    }

    .blue {
      background-color: var(--paper-light-blue-300);
    }
    .red {
      background-color: var(--paper-red-300);
    }
    .orange {
      background-color: var(--paper-amber-300);
    }
    .yellow {
      background-color: var(--paper-yellow-300);
    }
    .green {
      background-color: var(--paper-green-300);
    }

  </style>
  <template>
      <template is="dom-repeat" items="{{items}}">
        <section>
          <paper-material elevation="0">
            <div>
              <h4>{{item.name}}</h4>
              <h4>Bugs</h4>
              <div class="list">

                <template  is="dom-repeat" items="{{item.bugs}}" id="bugList" as="bug" index-as="bugIndex">
                  <paper-icon-item flex>
                    <div class$="{{toColor(bug.color)}}" item-icon></div>
                    <paper-item-body two-line>

                      <div>{{toTitleCase(bug.name)}}<span>&nbspPopulation:</span></div>
                      <div secondary><paper-slider min="10" max="300" value="{{bug.population}}" editable></paper-slider></div>
                      <!--<span><div >Population: </div><paper-slider min="10" max="300" value="{{bug.population}}" editable></paper-slider></paper-icon-item></span>-->
                    </paper-item-body>
                    <button itemid$="{{item.id}}" on-click="deleteSelection">Select</button>
                  </paper-icon-item>

                </template>
              </div>
            </div>
          </paper-material>
        </section>
      </template>
  </template>
<script>
  (function () {
    Polymer({
      is: 'my-list',
      properties: {
        items: {
          type: Array,
          notify: true,
          //observer: '_itemsChanged'
        }
      },

      observers: [
        'itemsAddedOrRemoved(items.*)'
      ],
      ready: function() {
        var app = document.querySelector('#app');
        this.items = app.items;
      },

      created: function() {
        console.log(this.localName + '#' + this.id + ' was created');
      },

      addScope: function(scopeName) {
        this.push('items', scopeName);
      },
      deleteSelection: function(event) {
        var bugIndex = event.model.bugIndex;
        var itemIndex = this.items.indexOf(event.model.item);
        var path = 'items.'+itemIndex+'.bugs';
        this.splice(path,bugIndex,1);
      },
      itemsAddedOrRemoved: function(changeRecord) {
        console.log('ITEMS changes added or removed items:');
        console.log(JSON.stringify(changeRecord, null, '\t'));

      },
      toColor: function(value) {
        if (value) {
          return 'avatar ' + value;
        }
      },
      toTitleCase: function(str) {
        return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
      },
    });
  })();
</script>
</dom-module>
